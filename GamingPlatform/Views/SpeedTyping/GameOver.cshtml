@{
    ViewData["Title"] = Localizer["Game.SpeedTyping.Title"].Value;
}

@section Styles {
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #2c3e50; /* Couleur sombre */
            color: #ecf0f1; /* Texte clair */
        }
        .card {
            background-color: #34495e;
            color: #ecf0f1;
        }
        .list-group-item {
            background-color: #2c3e50;
            color: #ecf0f1;
            border: 1px solid #34495e;
        }
        .list-group-item .badge {
            background-color: #e74c3c;
        }
        h2, h3 {
            font-weight: bold;
        }
        .btn-primary {
            background-color: #e74c3c;
            border-color: #e74c3c;
        }
        .btn-primary:hover {
            background-color: #c0392b;
            border-color: #c0392b;
        }
    </style>
}

<div class="container py-5">
    <div class="text-center mb-5">
        <i class="fa-solid fa-trophy fa-3x text-warning"></i>
        <h2 class="mt-3">@Localizer["SpeedTyping.GameOver.Title"]</h2>
    </div>
    <div id="podiumContainer" class="card shadow p-4"></div>
    <div class="text-center mt-4">
        <a href="/SpeedTyping" class="btn btn-primary">
            <i class="fa-solid fa-arrow-left"></i> @Localizer["SpeedTyping.GameOver.BackToLobbies"]
        </a>
    </div>
</div>

@section Scripts {
    <script>
        const i18n = {
            podiumTitle: "@System.Text.Encodings.Web.JavaScriptEncoder.Default.Encode(Localizer["SpeedTyping.GameOver.PodiumTitle"].Value)",
            noPlayers: "@System.Text.Encodings.Web.JavaScriptEncoder.Default.Encode(Localizer["SpeedTyping.GameOver.NoPlayers"].Value)",
            winnerIs: "@System.Text.Encodings.Web.JavaScriptEncoder.Default.Encode(Localizer["SpeedTyping.GameOver.WinnerIs"].Value)" // "{0}"
        };

        const podium = JSON.parse(localStorage.getItem("podium"));
        const winner = localStorage.getItem("winner");
        const container = document.getElementById("podiumContainer");

        container.innerHTML = "";

        if (podium && podium.length > 0) {
            const title = document.createElement("h3");
            title.className = "text-center";
            title.innerHTML = `<i class="fa-solid fa-medal"></i> ${i18n.podiumTitle}`;

            const list = document.createElement("ol");
            list.className = "list-group list-group-numbered mt-3";

            podium.forEach((p, index) => {
                let iconHtml = "";
                if (index === 0) iconHtml = '<i class="fa-solid fa-crown text-warning"></i>';
                else if (index === 1) iconHtml = '<i class="fa-solid fa-star text-secondary"></i>';
                else if (index === 2) iconHtml = '<i class="fa-solid fa-star-half-stroke text-secondary"></i>';

                const li = document.createElement("li");
                li.className = "list-group-item d-flex justify-content-between align-items-center";
                li.innerHTML = `${iconHtml} <span>${p.player}</span><span class="badge">${p.progress}%</span>`;
                list.appendChild(li);
            });

            container.appendChild(title);
            container.appendChild(list);
        } else {
            const empty = document.createElement("p");
            empty.className = "text-muted text-center";
            empty.innerHTML = `<i class="fa-solid fa-circle-info fa-2x"></i><br>${i18n.noPlayers}`;
            container.appendChild(empty);
        }

        if (winner) {
            const winnerEl = document.createElement("h3");
            winnerEl.className = "text-center mt-4 text-warning";
            winnerEl.innerHTML = `<i class="fa-solid fa-trophy"></i> ${i18n.winnerIs.replace("{0}", winner)}`;
            container.appendChild(winnerEl);
        }
    </script>
}
